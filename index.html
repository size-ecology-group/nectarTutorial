<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="RF">

<title>Sipping Nectar: A Guide to Setting Up Your RStudio Server on a Supercomputer</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#navigating-nectar-in-5-steps" id="toc-navigating-nectar-in-5-steps" class="nav-link" data-scroll-target="#navigating-nectar-in-5-steps">Navigating Nectar in 5 Steps</a>
  <ul class="collapse">
  <li><a href="#application-for-resources" id="toc-application-for-resources" class="nav-link" data-scroll-target="#application-for-resources">Application for resources</a></li>
  <li><a href="#security-setup" id="toc-security-setup" class="nav-link" data-scroll-target="#security-setup">Security setup</a>
  <ul class="collapse">
  <li><a href="#security-groups" id="toc-security-groups" class="nav-link" data-scroll-target="#security-groups">Security groups</a></li>
  <li><a href="#key-pairs" id="toc-key-pairs" class="nav-link" data-scroll-target="#key-pairs">Key pairs</a></li>
  </ul></li>
  <li><a href="#creating-an-instance" id="toc-creating-an-instance" class="nav-link" data-scroll-target="#creating-an-instance">Creating an instance</a></li>
  <li><a href="#connecting-for-the-first-time" id="toc-connecting-for-the-first-time" class="nav-link" data-scroll-target="#connecting-for-the-first-time">Connecting for the first time</a></li>
  <li><a href="#linking-storage" id="toc-linking-storage" class="nav-link" data-scroll-target="#linking-storage">Linking storage</a>
  <ul class="collapse">
  <li><a href="#create-your-volume" id="toc-create-your-volume" class="nav-link" data-scroll-target="#create-your-volume">create your volume</a></li>
  <li><a href="#mount-rd-type-storage" id="toc-mount-rd-type-storage" class="nav-link" data-scroll-target="#mount-rd-type-storage">Mount rd type storage</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#further-additions" id="toc-further-additions" class="nav-link" data-scroll-target="#further-additions">Further additions</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sipping Nectar: A Guide to Setting Up Your RStudio Server on a Supercomputer</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>RF </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The purpose of this tutorial is to guide you through the process of setting up an Rstudio session on Nectar. This tutorial provides a simplified and condensed version of the resources available at https://tutorials.rc.nectar.org.au. If you wish to explore more advanced features beyond what is covered in this tutorial, please feel free to visit the Nectar website.</p>
<p>There are several benefits to using a remote Rstudio server. First, it allows for increased flexibility, as you can access your R environment from anywhere with an internet connection. This means that you can work on projects from home, the office, or on the go. Second, a remote server can be much more powerful than a local machine, as it can leverage the resources of the cloud to handle complex analyses and large datasets. Finally, it can be more secure, as the server can be configured with specific security measures to protect your data.</p>
</section>
<section id="navigating-nectar-in-5-steps" class="level1">
<h1>Navigating Nectar in 5 Steps</h1>
<p>To get started, go to https://dashboard.rc.nectar.org.au/ and log in via AAF. Next, locate your organization (in this case, the University of Tasmania) and connect to your dashboard.</p>
<p>If you are connecting to Nectar for the first time, you will be allocated a project with limited resources (e.g., a few VCPUs and RAM) for a limited time, to help you get started.</p>
<p>If you need more resources, you will need to apply for them by submitting an application or being added to an existing project. Keep in mind that approval of resource requests may take some time, depending on the volume of applications being processed. Once you have access to your resources, you can proceed with setting up your Rstudio session using the instructions provided in this tutorial.</p>
<section id="application-for-resources" class="level2">
<h2 class="anchored" data-anchor-id="application-for-resources">Application for resources</h2>
<p>TODO</p>
<p>Once you have resources available in your project, you can start creating instances. If you have access to multiple projects, these can be selected in the top left corner in blue.</p>
</section>
<section id="security-setup" class="level2">
<h2 class="anchored" data-anchor-id="security-setup">Security setup</h2>
<p>On the side in “Project/Compute/Overview”, you can easily monitor the resources available to create instances. This section displays important details such as the number of instances you can create (you can have more than one per project), the number of VCPUs available (also known as the number of cores), and the amount of RAM that each instance has access to (also known as memory).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/overview.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Overview</figcaption><p></p>
</figure>
</div>
<p>The overview section is also useful for checking other details related to your project, such as the amount of storage available or networks in use. Keep in mind that the information displayed in the overview may vary depending on the type and size of your project, so it’s important to review this section carefully before launching your instance to ensure you have the resources you need. You can use this information to determine how many instances you can create and what size they should be to best fit your needs.</p>
<section id="security-groups" class="level3">
<h3 class="anchored" data-anchor-id="security-groups">Security groups</h3>
<p>Security groups provide network access to your instances. We will configure two security groups for ease of use. You can view existing security groups in the Network/Security Groups section.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/security.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Security groups</figcaption><p></p>
</figure>
</div>
<p>We will create a security group to connect via SSH and another to connect directly to Rstudio via a browser. If these groups already exist, you can skip the following section.</p>
<p>To create a new security group, click on the “Create Security Group” button. You will be prompted to enter a name and an optional description for the new security group. After clicking “Create Security Group,” you will be able to edit the group’s rules.</p>
<p>For SSH, we will add an ingress rule that is already pre-configured. Click on “Add New Rule” and select SSH in the first dropdown menu.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ssh.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">SSH security group</figcaption><p></p>
</figure>
</div>
<p>The rest of the fields will be automatically filled, so just click “Add” to create a new security group for configuring the SSH connection.</p>
<p>For Rstudio, we will add a custom ingress rule. Select “Custom TCP Rule” and add “8787” to the “Port” field, as shown in the picture below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/rstudio.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Custom Rstudio security group</figcaption><p></p>
</figure>
</div>
<p>This will allow you to access Rstudio directly from a browser.</p>
</section>
<section id="key-pairs" class="level3">
<h3 class="anchored" data-anchor-id="key-pairs">Key pairs</h3>
<p>To work with SSH on Nectar, you’ll need to set up an SSH key pair on your laptop and then upload it to Nectar. Here’s how to do it:</p>
<ol type="1">
<li>Open a terminal on your laptop and type the following command:</li>
</ol>
<pre class="{bash}"><code>ssh-keygen</code></pre>
<ol start="2" type="1">
<li><p>You will be prompted to enter the path where you want to save the new key pair. By default, keys are usually stored in the “Users/yourname/.ssh/” folder, but you can choose to save them anywhere. Be sure to keep track of where you save the key pair, as keys cannot be recovered if lost.</p></li>
<li><p>Once the key pair is saved, the private key (which has no file extension) will remain on your laptop and serve to identify yourself to the instance. The public key (which has a “.pub” file extension) will be uploaded to Nectar. To do this, go to “Compute/Key pair” and then click “Import Public Key”. Give the key a name that you can easily link back to the key on your computer, and then import the public part of the key. Make sure to set the key type to “SSH”.</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/keypair.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Public key import</figcaption><p></p>
</figure>
</div>
<ol start="4" type="1">
<li>Once the key is imported, it will be available to select when creating a new instance.</li>
</ol>
<p>Using an SSH key pair is a more secure way to access your remote instance than using a password. By using a key pair, you can avoid transmitting your password over the network, and you can also revoke access to your instance by removing the public key from the authorized list.</p>
</section>
</section>
<section id="creating-an-instance" class="level2">
<h2 class="anchored" data-anchor-id="creating-an-instance">Creating an instance</h2>
<p>In the Project/Compute/Instance tab, you can view your current instances and create a new one.</p>
<p><img src="img/instances.png" class="img-fluid" alt="Launching a new instance"> To create a new instance, click on the “launch instance” button. This will bring up a new menu, as shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/instance_detail.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Details</figcaption><p></p>
</figure>
</div>
<p>The project name will be automatically filled in. Give your instance a name and select one of the Tasmanian servers in the availability zone. Use the “count” field if you need to create multiple instances.</p>
<p>Next, select the operating system you want to install on the new instance.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/source.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Source</figcaption><p></p>
</figure>
</div>
<p>In our case, we want the latest version of the Nectar R Studio in the list, as shown in the picture. This will automatically install Linux with R and RStudio on the instance without requiring any setup on your part.</p>
<p>The next step is to allocate the resources you want for the instance. This will depend on how much is available and how much you need to work with. For reference, an average laptop has 8 VCPUs and 16 GB of RAM.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/flavor.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Flavor</figcaption><p></p>
</figure>
</div>
<p>Next, use the security groups we created earlier. Allocate the available security groups as shown in the picture. We need to be able to connect via SSH and HTTPS (RStudio group). You can also create an admin password, although this feature may not be currently working.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/instance_security.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Security groups</figcaption><p></p>
</figure>
</div>
<p>Finally, since we want to use SSH, we need to assign a public key to the instance. Select the key you are using from the “available” list, or import one if you haven’t already.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/instance_key.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Key Pair</figcaption><p></p>
</figure>
</div>
<p>You can ignore the last three tabs. Click “Launch instance” to create your new instance. The creation process may take a while, depending on the instance’s size.</p>
<p>Once the instance is created, an IP address will be assigned to it. This IP address will be used to connect to the instance.”</p>
</section>
<section id="connecting-for-the-first-time" class="level2">
<h2 class="anchored" data-anchor-id="connecting-for-the-first-time">Connecting for the first time</h2>
<p>To access the newly created RStudio server, we first need to connect to the instance via SSH since there is no password set up for the admin account. You can open a terminal on your laptop (Mac/Linux) or use MobaXterm (GUI for Windows, https://mobaxterm.mobatek.net). In the terminal, type the following command, replacing “path_to_private_key” with the actual path to the private key and “IP_address” with the instance’s IP address:</p>
<pre class="{bash}"><code>ssh -i path_to_private_key ubuntu@IP_adress</code></pre>
<p>If the command is successful, you will be remotely connected to the instance. If not, double-check that the path and IP address are correct. After successfully connecting, change the password by typing the following command and following the prompts:</p>
<pre class="{bash}"><code>sudo passwd ubuntu</code></pre>
<p>Please note that passwords do not appear on the screen as you type them in Linux.</p>
<p>With the password now set, open a browser and type your instance’s IP address followed by “:8787” (without quotes) in the address bar. This will take you to an RStudio login page where you will be prompted to enter your username and password. The username will be “ubuntu” unless you created more users while setting up the instance.</p>
</section>
<section id="linking-storage" class="level2">
<h2 class="anchored" data-anchor-id="linking-storage">Linking storage</h2>
<section id="create-your-volume" class="level3">
<h3 class="anchored" data-anchor-id="create-your-volume">create your volume</h3>
</section>
<section id="mount-rd-type-storage" class="level3">
<h3 class="anchored" data-anchor-id="mount-rd-type-storage">Mount rd type storage</h3>
<p>This is an example on how I mount /rd containing the FishMIP data on my instances.</p>
<p>First, ask for permission of read/write for /rd1… on the IP to Geli. Then write in the command line:</p>
<pre class="{bash}"><code>
sudo vi /etc/fstab

#in vim add
data5.tpac.org.au:/rd1/gem/PUBLIC /rd/gem/public/ nfs nfsvers=3,rw,nosuid,hard,intr,bg,proto=tcp 0 0
data5.tpac.org.au:/rd1/gem/PRIVATE /rd/gem/private/ nfs nfsvers=3,rw,nosuid,hard,intr,bg,proto=tcp 0 0

# create the folders where the mount is going to happen
sudo mkdir -p /rd/gem/private
sudo mkdir -p /rd/gem/public

# might need these packages
sudo apt install nfs-common
sudo apt install cifs-utils

# mount
sudo mount -a
</code></pre>
</section>
</section>
</section>
<section id="further-additions" class="level1">
<h1>Further additions</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>